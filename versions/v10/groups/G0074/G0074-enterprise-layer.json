{"description": "Enterprise techniques used by Dragonfly 2.0, ATT&CK group G0074 v2.1", "name": "Dragonfly 2.0 (G0074)", "domain": "enterprise-attack", "versions": {"layer": "4.3", "attack": "10", "navigator": "4.5"}, "techniques": [{"techniqueID": "T1087", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1087.002", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used batch scripts to enumerate users on a victim domain controller.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1098", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) added newly created accounts to the administrators group to maintain elevated access.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1071", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used SMB for C2.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1560", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) compressed data into .zip files prior to exfiltrating it.(Citation: US-CERT TA18-074A)"}, {"techniqueID": "T1547", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1547.001", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) added the registry value ntdll to the Registry Run key to establish persistence.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1547.009", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) manipulated .lnk files to gather user credentials in conjunction with [Forced Authentication](https://attack.mitre.org/techniques/T1187).(Citation: US-CERT TA18-074A)"}, {"techniqueID": "T1110", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1110.002", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed tools used for password cracking, including Hydra and [CrackMapExec](https://attack.mitre.org/software/S0488).(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)(Citation: Kali Hydra)"}, {"score": 1, "techniqueID": "T1059", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used command line for execution.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1059.001", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used PowerShell scripts for execution.(Citation: US-CERT TA18-074A)(Citation: Symantec Dragonfly Sept 2017)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1059.003", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used various types of scripting to perform operations, including batch scripts.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1059.006", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used various types of scripting to perform operations, including Python scripts. The group was observed installing Python 2.7 on a victim.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"techniqueID": "T1136", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1136.001", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created accounts on victims, including administrator accounts, some of which appeared to be tailored to each individual staging target.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1005", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) collected data from local victim systems.(Citation: US-CERT TA18-074A)"}, {"techniqueID": "T1074", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1074.001", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created a directory named \"out\" in the user's %AppData% folder and copied files to it.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1189", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) compromised legitimate organizations' websites to create watering holes to compromise victims.(Citation: US-CERT TA18-074A)"}, {"techniqueID": "T1114", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1114.002", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) accessed email accounts using Outlook Web Access.(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1133", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used VPNs and Outlook Web Access (OWA) to maintain access to victim networks.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1083", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used a batch script to gather folder and file names from victim hosts.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1187", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has gathered hashed user credentials over SMB using spearphishing attachments with external resource links and by modifying .LNK file icon resources to collect credentials from virtualized systems.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"techniqueID": "T1564", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1564.002", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) modified the Registry to hide create user accounts. (Citation: US-CERT TA18-074A)"}, {"techniqueID": "T1562", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1562.004", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has disabled host-based firewalls. The group has also globally opened port 3389.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"techniqueID": "T1070", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1070.001", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) cleared Windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs. The actors also deleted specific Registry keys.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1070.004", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) deleted many of its files used during operations as part of cleanup, including removing applications and deleting screenshots.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1105", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) copied and installed tools for operations once in the victim environment.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1036", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) created accounts disguised as legitimate backup and service accounts as well as an email administration account.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1112", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) modified the Registry to perform multiple techniques through the use of [Reg](https://attack.mitre.org/software/S0075).(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1135", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"techniqueID": "T1003", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1003.002", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed SecretsDump to dump password hashes.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1003.003", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed SecretsDump to dump password hashes. They also obtained ntds.dit from domain controllers. (Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)(Citation: Core Security Impacket)"}, {"score": 1, "techniqueID": "T1003.004", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) dropped and executed SecretsDump to dump password hashes.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)(Citation: Core Security Impacket)"}, {"techniqueID": "T1069", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1069.002", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used batch scripts to enumerate administrators and users in the domain.(Citation: US-CERT TA18-074A)"}, {"techniqueID": "T1566", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1566.001", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used spearphishing with Microsoft Office attachments to target victims.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1566.002", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used spearphishing with PDF attachments containing malicious links that redirected to credential harvesting websites.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1012", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) queried the Registry to identify victim information.(Citation: US-CERT TA18-074A)"}, {"techniqueID": "T1021", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1021.001", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) moved laterally via RDP.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1018", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) likely obtained a list of hosts in the victim environment.(Citation: US-CERT TA18-074A)"}, {"techniqueID": "T1053", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1053.005", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used scheduled tasks to automatically log out of created accounts every 8 hours as well as to execute malicious files.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1113", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has performed screen captures of victims, including by using a tool, scr.exe (which matched the hash of ScreenUtil).(Citation: US-CERT TA18-074A)(Citation: Symantec Dragonfly Sept 2017)"}, {"techniqueID": "T1505", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1505.003", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) commonly created Web shells on victims' publicly accessible email and web servers, which they used to maintain access to a victim network and download additional malicious files.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1016", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used batch scripts to enumerate network information, including information about trusts, zones, and the domain.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1033", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) used the command query user on victim hosts.(Citation: US-CERT TA18-074A)"}, {"score": 1, "techniqueID": "T1221", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has injected SMB URLs into malicious Word spearphishing attachments to initiate [Forced Authentication](https://attack.mitre.org/techniques/T1187).(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"techniqueID": "T1204", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1204.001", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has used various forms of spearphishing in attempts to get users to open links.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1204.002", "showSubtechniques": true, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) has used various forms of spearphishing in attempts to get users to open attachments.(Citation: US-CERT TA18-074A)(Citation: US-CERT APT Energy Oct 2017)"}, {"score": 1, "techniqueID": "T1078", "showSubtechniques": false, "comment": "[Dragonfly 2.0](https://attack.mitre.org/groups/G0074) compromised user credentials and used valid accounts for operations.(Citation: US-CERT TA18-074A)"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Dragonfly 2.0", "color": "#66b1ff"}]}