{"description": "Enterprise techniques used by Audit, ATT&CK mitigation M1047 v1.1", "name": "Audit (M1047)", "domain": "enterprise-attack", "versions": {"layer": "4.3", "attack": "10", "navigator": "4.5"}, "techniques": [{"score": 1, "techniqueID": "T1548", "showSubtechniques": true, "comment": "Check for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate.(Citation: Github UACMe)"}, {"score": 1, "techniqueID": "T1548.002", "showSubtechniques": true, "comment": "Check for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate.(Citation: Github UACMe)"}, {"techniqueID": "T1087", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1087.004", "showSubtechniques": true, "comment": "Routinely check user permissions to ensure only the expected users have the ability to list IAM identities or otherwise discover cloud accounts."}, {"score": 1, "techniqueID": "T1560", "showSubtechniques": true, "comment": "System scans can be performed to identify unauthorized archival utilities."}, {"score": 1, "techniqueID": "T1560.001", "showSubtechniques": true, "comment": "System scans can be performed to identify unauthorized archival utilities."}, {"score": 1, "techniqueID": "T1176", "showSubtechniques": false, "comment": " Ensure extensions that are installed are the intended ones as many malicious extensions will masquerade as legitimate ones."}, {"score": 1, "techniqueID": "T1612", "showSubtechniques": false, "comment": "Audit images deployed within the environment to ensure they do not contain any malicious components."}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.006", "showSubtechniques": true, "comment": "Inventory systems for unauthorized Python installations."}, {"score": 1, "techniqueID": "T1543", "showSubtechniques": true, "comment": "Use auditing tools capable of detecting privilege and service abuse opportunities on systems within an enterprise and correct them."}, {"score": 1, "techniqueID": "T1543.003", "showSubtechniques": true, "comment": "Use auditing tools capable of detecting privilege and service abuse opportunities on systems within an enterprise and correct them. "}, {"score": 1, "techniqueID": "T1543.004", "showSubtechniques": true, "comment": "Use auditing tools capable of detecting folder permissions abuse opportunities on systems, especially reviewing changes made to folders by third-party software."}, {"score": 1, "techniqueID": "T1530", "showSubtechniques": false, "comment": "Frequently check permissions on cloud storage to ensure proper permissions are set to deny open or unprivileged access to resources.(Citation: Amazon S3 Security, 2019)"}, {"score": 1, "techniqueID": "T1213", "showSubtechniques": true, "comment": "Consider periodic review of accounts and privileges for critical and sensitive repositories."}, {"score": 1, "techniqueID": "T1213.001", "showSubtechniques": true, "comment": "Consider periodic review of accounts and privileges for critical and sensitive Confluence repositories."}, {"score": 1, "techniqueID": "T1213.002", "showSubtechniques": true, "comment": "Consider periodic review of accounts and privileges for critical and sensitive SharePoint repositories."}, {"score": 1, "techniqueID": "T1213.003", "showSubtechniques": true, "comment": "Consider periodic reviews of accounts and privileges for critical and sensitive code repositories. Scan code repositories for exposed credentials or other sensitive information."}, {"score": 1, "techniqueID": "T1484", "showSubtechniques": true, "comment": "Identify and correct GPO permissions abuse opportunities (ex: GPO modification privileges) using auditing tools such as [BloodHound](https://attack.mitre.org/software/S0521) (version 1.5.1 and later)(Citation: GitHub Bloodhound)."}, {"score": 1, "techniqueID": "T1484.001", "showSubtechniques": true, "comment": "Identify and correct GPO permissions abuse opportunities (ex: GPO modification privileges) using auditing tools such as [BloodHound](https://attack.mitre.org/software/S0521) (version 1.5.1 and later).(Citation: GitHub Bloodhound)"}, {"score": 1, "techniqueID": "T1482", "showSubtechniques": false, "comment": "Map the trusts within existing domains/forests and keep trust relationships to a minimum."}, {"score": 1, "techniqueID": "T1114", "showSubtechniques": true, "comment": "Enterprise email solutions have monitoring mechanisms that may include the ability to audit auto-forwarding rules on a regular basis.\n\nIn an Exchange environment, Administrators can use Get-InboxRule to discover and remove potentially malicious auto-forwarding rules.(Citation: Microsoft Tim McMichael Exchange Mail Forwarding 2) "}, {"score": 1, "techniqueID": "T1114.003", "showSubtechniques": true, "comment": "Enterprise email solutions have monitoring mechanisms that may include the ability to audit auto-forwarding rules on a regular basis.\n\nIn an Exchange environment, Administrators can use Get-InboxRule to discover and remove potentially malicious auto-forwarding rules.(Citation: Microsoft Tim McMichael Exchange Mail Forwarding 2). In addition to this, a MAPI Editor can be utilized to examine the underlying database structure and discover any modifications/tampering of the properties of auto-forwarding rules.(Citation: Pfammatter - Hidden Inbox Rules)"}, {"techniqueID": "T1546", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1546.006", "showSubtechniques": true, "comment": "Binaries can also be baselined for what dynamic libraries they require, and if an app requires a new dynamic library that wasn\\u2019t included as part of an update, it should be investigated."}, {"score": 1, "techniqueID": "T1606", "showSubtechniques": true, "comment": "Administrators should perform an audit of all access lists and the permissions they have been granted to access web applications and services. This should be done extensively on all resources in order to establish a baseline, followed up on with periodic audits of new or updated resources. Suspicious accounts/credentials should be investigated and removed.\n \nEnable advanced auditing on ADFS. Check the success and failure audit options in the ADFS Management snap-in. Enable Audit Application Generated events on the AD FS farm via Group Policy Object.(Citation: FireEye ADFS)"}, {"score": 1, "techniqueID": "T1606.001", "showSubtechniques": true, "comment": "Administrators should perform an audit of all access lists and the permissions they have been granted to access web applications and services. This should be done extensively on all resources in order to establish a baseline, followed up on with periodic audits of new or updated resources. Suspicious accounts/credentials should be investigated and removed."}, {"score": 1, "techniqueID": "T1606.002", "showSubtechniques": true, "comment": "Enable advanced auditing on AD FS. Check the success and failure audit options in the AD FS Management snap-in. Enable Audit Application Generated events on the AD FS farm via Group Policy Object.(Citation: FireEye ADFS)"}, {"techniqueID": "T1564", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1564.008", "showSubtechniques": true, "comment": "Enterprise email solutions may have monitoring mechanisms that may include the ability to audit inbox rules on a regular basis. \n\nIn an Exchange environment, Administrators can use Get-InboxRule to discover and remove potentially malicious inbox rules.(Citation: Microsoft Get-InboxRule)"}, {"score": 1, "techniqueID": "T1574", "showSubtechniques": true, "comment": "Use auditing tools capable of detecting hijacking opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for hijacking weaknesses.(Citation: Powersploit)\n\nUse the program sxstrace.exe that is included with Windows along with manual inspection to check manifest files for side-loading vulnerabilities in software.\n\nFind and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.\n\nClean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.(Citation: Microsoft CreateProcess)(Citation: Microsoft Dynamic-Link Library Security)(Citation: Vulnerability and Exploit Detector)"}, {"score": 1, "techniqueID": "T1574.001", "showSubtechniques": true, "comment": "Use auditing tools capable of detecting DLL search order hijacking opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for DLL hijacking weaknesses.(Citation: Powersploit)\n\nUse the program sxstrace.exe that is included with Windows along with manual inspection to check manifest files for side-by-side problems in software.(Citation: Microsoft Sxstrace)"}, {"score": 1, "techniqueID": "T1574.005", "showSubtechniques": true, "comment": "Use auditing tools capable of detecting file system permissions abuse opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for service file system permissions weaknesses.(Citation: Powersploit)"}, {"score": 1, "techniqueID": "T1574.007", "showSubtechniques": true, "comment": "Find and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.\n\nClean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.(Citation: Microsoft CreateProcess)(Citation: Microsoft Dynamic-Link Library Security)(Citation: Vulnerability and Exploit Detector)"}, {"score": 1, "techniqueID": "T1574.008", "showSubtechniques": true, "comment": "Find and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.\n\nClean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.(Citation: Microsoft CreateProcess)(Citation: Microsoft Dynamic-Link Library Security)(Citation: Vulnerability and Exploit Detector)"}, {"score": 1, "techniqueID": "T1574.009", "showSubtechniques": true, "comment": "Find and eliminate path interception weaknesses in program configuration files, scripts, the PATH environment variable, services, and in shortcuts by surrounding PATH variables with quotation marks when functions allow for them. Be aware of the search order Windows uses for executing or loading binaries and use fully qualified paths wherever appropriate.\n\nClean up old Windows Registry keys when software is uninstalled to avoid keys with no associated legitimate binaries. Periodically search for and correct or report path interception weaknesses on systems that may have been introduced using custom or available tools that report software using insecure path configurations.(Citation: Microsoft CreateProcess)(Citation: Microsoft Dynamic-Link Library Security)(Citation: Vulnerability and Exploit Detector)"}, {"score": 1, "techniqueID": "T1574.010", "showSubtechniques": true, "comment": "Use auditing tools capable of detecting file system permissions abuse opportunities on systems within an enterprise and correct them. Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for service file system permissions weaknesses.(Citation: Powersploit)"}, {"techniqueID": "T1562", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1562.002", "showSubtechniques": true, "comment": "Consider periodic review of auditpol settings for Administrator accounts and perform dynamic baselining on SIEM(s) to investigate potential malicious activity. Also ensure that the EventLog service and its threads are properly running."}, {"score": 1, "techniqueID": "T1562.007", "showSubtechniques": true, "comment": "Routinely check account role permissions to ensure only expected users and roles have permission to modify cloud firewalls. "}, {"score": 1, "techniqueID": "T1525", "showSubtechniques": false, "comment": "Periodically check the integrity of images and containers used in cloud deployments to ensure they have not been modified to include malicious software."}, {"score": 1, "techniqueID": "T1578", "showSubtechniques": true, "comment": "Routinely monitor user permissions to ensure only the expected users have the capability to modify cloud compute infrastructure components."}, {"score": 1, "techniqueID": "T1578.001", "showSubtechniques": true, "comment": "Routinely check user permissions to ensure only the expected users have the capability to create snapshots and backups."}, {"score": 1, "techniqueID": "T1578.002", "showSubtechniques": true, "comment": "Routinely check user permissions to ensure only the expected users have the capability to create new instances."}, {"score": 1, "techniqueID": "T1578.003", "showSubtechniques": true, "comment": "Routinely check user permissions to ensure only the expected users have the capability to delete new instances."}, {"techniqueID": "T1542", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1542.004", "showSubtechniques": true, "comment": "Periodically check the integrity of system image to ensure it has not been modified. (Citation: Cisco IOS Software Integrity Assurance - Image File Integrity) (Citation: Cisco IOS Software Integrity Assurance - Image File Verification) (Citation: Cisco IOS Software Integrity Assurance - Change Control) "}, {"score": 1, "techniqueID": "T1542.005", "showSubtechniques": true, "comment": "Periodically check the integrity of the running configuration and system image to ensure they have not been modified. (Citation: Cisco IOS Software Integrity Assurance - Image File Verification) (Citation: Cisco IOS Software Integrity Assurance - Image File Integrity) (Citation: Cisco IOS Software Integrity Assurance - Change Control) "}, {"techniqueID": "T1563", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1563.002", "showSubtechniques": true, "comment": "Audit the Remote Desktop Users group membership regularly. Remove unnecessary accounts and groups from Remote Desktop Users groups."}, {"techniqueID": "T1021", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1021.001", "showSubtechniques": true, "comment": "Audit the Remote Desktop Users group membership regularly. Remove unnecessary accounts and groups from Remote Desktop Users groups."}, {"score": 1, "techniqueID": "T1021.005", "showSubtechniques": true, "comment": "Inventory workstations for unauthorized VNC server software."}, {"score": 1, "techniqueID": "T1053", "showSubtechniques": true, "comment": "Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges. (Citation: Powersploit)"}, {"score": 1, "techniqueID": "T1053.001", "showSubtechniques": true, "comment": "Scheduled tasks using [at](https://attack.mitre.org/software/S0110) can be audited locally, or through centrally collected logging, using syslog, or auditd events from the host. (Citation: Kifarunix - Task Scheduling in Linux)"}, {"score": 1, "techniqueID": "T1053.002", "showSubtechniques": true, "comment": "Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges. (Citation: Powersploit) Windows operating system also creates a registry key specifically associated with the creation of a scheduled task on the destination host at: Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tree\\At1. (Citation: Secureworks - AT.exe Scheduled Task)"}, {"score": 1, "techniqueID": "T1053.003", "showSubtechniques": true, "comment": "Review changes to the cron schedule. cron execution can be reviewed within the /var/log directory. To validate the location of the cron log file, check the syslog config at /etc/rsyslog.conf or /etc/syslog.conf "}, {"score": 1, "techniqueID": "T1053.005", "showSubtechniques": true, "comment": "Toolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges. (Citation: Powersploit)"}, {"score": 1, "techniqueID": "T1505", "showSubtechniques": true, "comment": "Regularly check component software on critical services that adversaries may target for persistence to verify the integrity of the systems and identify if unexpected changes have been made."}, {"score": 1, "techniqueID": "T1505.001", "showSubtechniques": true, "comment": "Regularly check component software on critical services that adversaries may target for persistence to verify the integrity of the systems and identify if unexpected changes have been made. "}, {"score": 1, "techniqueID": "T1505.002", "showSubtechniques": true, "comment": "Regularly check component software on critical services that adversaries may target for persistence to verify the integrity of the systems and identify if unexpected changes have been made. "}, {"score": 1, "techniqueID": "T1505.004", "showSubtechniques": true, "comment": "Regularly check installed IIS components to verify the integrity of the web server and identify if unexpected changes have been made."}, {"score": 1, "techniqueID": "T1528", "showSubtechniques": false, "comment": "Administrators should perform an audit of all OAuth applications and the permissions they have been granted to access organizational data. This should be done extensively on all applications in order to establish a baseline, followed up on with periodic audits of new or updated applications. Suspicious applications should be investigated and removed."}, {"techniqueID": "T1558", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1558.004", "showSubtechniques": true, "comment": "Kerberos preauthentication is enabled by default. Older protocols might not support preauthentication therefore it is possible to have this setting disabled. Make sure that all accounts have preauthentication whenever possible and audit changes to setting. Windows tools such as PowerShell may be used to easily find which accounts have preauthentication disabled.  (Citation: Microsoft Preauthentication Jul 2012)(Citation: Stealthbits Cracking AS-REP Roasting Jun 2019)"}, {"score": 1, "techniqueID": "T1552", "showSubtechniques": true, "comment": "Preemptively search for files containing passwords or other credentials and take actions to reduce the exposure risk when found."}, {"score": 1, "techniqueID": "T1552.001", "showSubtechniques": true, "comment": "Preemptively search for files containing passwords and take actions to reduce the exposure risk when found."}, {"score": 1, "techniqueID": "T1552.002", "showSubtechniques": true, "comment": "Proactively search for credentials within the Registry and attempt to remediate the risk."}, {"score": 1, "techniqueID": "T1552.004", "showSubtechniques": true, "comment": "Ensure only authorized keys are allowed access to critical resources and audit access lists regularly."}, {"score": 1, "techniqueID": "T1552.006", "showSubtechniques": true, "comment": "Search SYSVOL for any existing GGPs that may contain credentials and remove them.(Citation: ADSecurity Finding Passwords in SYSVOL)"}, {"techniqueID": "T1550", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1550.001", "showSubtechniques": true, "comment": "Administrators can leverage audit tools to monitor actions that can be conducted as a result of OAuth 2.0 access. For instance, audit reports enable admins to identify privilege escalation actions such as role creations or policy modifications, which could be actions performed after initial access."}, {"techniqueID": "T1204", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1204.003", "showSubtechniques": true, "comment": "Audit images deployed within the environment to ensure they do not contain any malicious components."}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Audit", "color": "#66b1ff"}]}