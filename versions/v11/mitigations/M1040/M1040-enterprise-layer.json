{"description": "Enterprise techniques used by Behavior Prevention on Endpoint, ATT&CK mitigation M1040 v1.0", "name": "Behavior Prevention on Endpoint (M1040)", "domain": "enterprise-attack", "versions": {"layer": "4.3", "attack": "11", "navigator": "4.5"}, "techniques": [{"score": 1, "techniqueID": "T1059", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent [Visual Basic](https://attack.mitre.org/techniques/T1059/005) and [JavaScript](https://attack.mitre.org/techniques/T1059/007) scripts from executing potentially malicious downloaded content (Citation: win10_asr)."}, {"score": 1, "techniqueID": "T1059.005", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent [Visual Basic](https://attack.mitre.org/techniques/T1059/005) scripts from executing potentially malicious downloaded content (Citation: win10_asr)."}, {"score": 1, "techniqueID": "T1059.007", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent [JavaScript](https://attack.mitre.org/techniques/T1059/007) scripts from executing potentially malicious downloaded content (Citation: win10_asr)."}, {"score": 1, "techniqueID": "T1543", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent an application from writing a signed vulnerable driver to the system.(Citation: Malicious Driver Reporting Center) On Windows 10 and 11, enable Microsoft Vulnerable Driver Blocklist to assist in hardening against third party-developed drivers.(Citation: Microsoft driver block rules)  "}, {"score": 1, "techniqueID": "T1543.003", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent an application from writing a signed vulnerable driver to the system.(Citation: Malicious Driver Reporting Center) On Windows 10 and 11, enable Microsoft Vulnerable Driver Blocklist to assist in hardening against third party-developed service drivers.(Citation: Microsoft driver block rules)  "}, {"score": 1, "techniqueID": "T1486", "showSubtechniques": false, "comment": "On Windows 10, enable cloud-delivered protection and Attack Surface Reduction (ASR) rules to block the execution of files that resemble ransomware. (Citation: win10_asr)"}, {"techniqueID": "T1546", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1546.003", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent malware from abusing WMI to attain persistence.(Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1574", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of behaviors related to process injection/memory tampering based on common sequences of indicators (ex: execution of specific API functions)."}, {"score": 1, "techniqueID": "T1574.013", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of behaviors related to process injection/memory tampering based on common sequences of indicators (ex: execution of specific API functions)."}, {"score": 1, "techniqueID": "T1559", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent DDE attacks and spawning of child processes from Office programs.(Citation: Microsoft ASR Nov 2017)(Citation: Enigma Reviving DDE Jan 2018)"}, {"score": 1, "techniqueID": "T1559.002", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent DDE attacks and spawning of child processes from Office programs.(Citation: Microsoft ASR Nov 2017)(Citation: Enigma Reviving DDE Jan 2018)"}, {"score": 1, "techniqueID": "T1106", "showSubtechniques": false, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office VBA macros from calling Win32 APIs. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1027", "showSubtechniques": false, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent execution of potentially obfuscated scripts. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1137", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1137.001", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1137.002", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1137.003", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1137.004", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1137.005", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1137.006", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1003", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to secure LSASS and prevent credential stealing. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1003.001", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to secure LSASS and prevent credential stealing. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1055", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. For example, on Windows 10, Attack Surface Reduction (ASR) rules may prevent Office applications from code injection. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1055.001", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "}, {"score": 1, "techniqueID": "T1055.002", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "}, {"score": 1, "techniqueID": "T1055.003", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "}, {"score": 1, "techniqueID": "T1055.004", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "}, {"score": 1, "techniqueID": "T1055.005", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "}, {"score": 1, "techniqueID": "T1055.008", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "}, {"score": 1, "techniqueID": "T1055.009", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "}, {"score": 1, "techniqueID": "T1055.011", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "}, {"score": 1, "techniqueID": "T1055.012", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "}, {"score": 1, "techniqueID": "T1055.013", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "}, {"score": 1, "techniqueID": "T1055.014", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process. "}, {"score": 1, "techniqueID": "T1055.015", "showSubtechniques": true, "comment": "Some endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process."}, {"score": 1, "techniqueID": "T1091", "showSubtechniques": false, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to block unsigned/untrusted executable files (such as .exe, .dll, or .scr) from running from USB removable drives. (Citation: win10_asr)"}, {"techniqueID": "T1216", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1216.001", "showSubtechniques": true, "comment": "On Windows 10, update Windows Defender Application Control policies to include rules that block the older, vulnerable versions of PubPrn.(Citation: Microsoft_rec_block_rules)"}, {"score": 1, "techniqueID": "T1569", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to block processes created by [PsExec](https://attack.mitre.org/software/S0029) from running. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1569.002", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to block processes created by [PsExec](https://attack.mitre.org/software/S0029) from running. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1204", "showSubtechniques": true, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to prevent executable files from running unless they meet a prevalence, age, or trusted list criteria and to prevent Office applications from creating potentially malicious executable content by blocking malicious code from being written to disk. Note: cloud-delivered protection must be enabled to use certain rules. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1204.002", "showSubtechniques": true, "comment": "On Windows 10, various Attack Surface Reduction (ASR) rules can be enabled to prevent the execution of potentially malicious executable files (such as those that have been downloaded and executed by Office applications/scripting interpreters/email clients or that do not meet specific prevalence, age, or trusted list criteria). Note: cloud-delivered protection must be enabled for certain rules. (Citation: win10_asr)"}, {"score": 1, "techniqueID": "T1047", "showSubtechniques": false, "comment": "On Windows 10, enable Attack Surface Reduction (ASR) rules to block processes created by WMI commands from running. Note: many legitimate tools and applications utilize WMI for command execution. (Citation: win10_asr)"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Behavior Prevention on Endpoint", "color": "#66b1ff"}]}