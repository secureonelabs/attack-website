{"description": "Enterprise techniques used by AADInternals, ATT&CK software S0677 v1.0", "name": "AADInternals (S0677)", "domain": "enterprise-attack", "versions": {"layer": "4.3", "attack": "11", "navigator": "4.5"}, "techniques": [{"techniqueID": "T1087", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1087.004", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can enumerate Azure AD users.(Citation: AADInternals Documentation)"}, {"techniqueID": "T1098", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1098.005", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can register a device to Azure AD.(Citation: AADInternals Documentation)"}, {"score": 1, "techniqueID": "T1526", "showSubtechniques": false, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can enumerate information about a variety of cloud services, such as Office 365 and Sharepoint instances or OpenID Configurations.(Citation: AADInternals Documentation)"}, {"techniqueID": "T1059", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1059.001", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) is written and executed via PowerShell.(Citation: AADInternals Documentation)"}, {"techniqueID": "T1136", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1136.003", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can create new Azure AD users.(Citation: AADInternals Documentation)"}, {"score": 1, "techniqueID": "T1484", "showSubtechniques": false, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can create a backdoor by converting a domain to a federated domain which will be able to authenticate any user across the tenant. [AADInternals](https://attack.mitre.org/software/S0677) can also modify DesktopSSO information.(Citation: AADInternals Documentation)(Citation: Azure AD Federation Vulnerability)"}, {"techniqueID": "T1606", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1606.002", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can be used to create SAML tokens using the AD Federated Services token signing certificate.(Citation: AADInternals Documentation)"}, {"techniqueID": "T1589", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1589.002", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can check for the existence of user email addresses using public Microsoft APIs.(Citation: AADInternals Documentation)(Citation: Azure AD Recon)"}, {"techniqueID": "T1590", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1590.001", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can gather information about a tenant\u2019s domains using public Microsoft APIs.(Citation: AADInternals Documentation)(Citation: Azure AD Recon)"}, {"score": 1, "techniqueID": "T1112", "showSubtechniques": false, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can modify registry keys as part of setting a new pass-through authentication agent.(Citation: AADInternals Documentation)"}, {"techniqueID": "T1003", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1003.004", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can dump secrets from the Local Security Authority.(Citation: AADInternals Documentation)"}, {"techniqueID": "T1069", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1069.003", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can enumerate Azure AD groups.(Citation: AADInternals Documentation)"}, {"techniqueID": "T1566", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1566.002", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can send \"consent phishing\" emails containing malicious links designed to steal users\u2019 access tokens.(Citation: AADInternals Documentation)"}, {"techniqueID": "T1598", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1598.003", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can send phishing emails containing malicious links designed to collect users\u2019 credentials.(Citation: AADInternals Documentation)"}, {"score": 1, "techniqueID": "T1528", "showSubtechniques": false, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can steal users\u2019 access tokens via phishing emails containing malicious links.(Citation: AADInternals Documentation)"}, {"techniqueID": "T1558", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1558.002", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can be used to forge Kerberos tickets using the password hash of the AZUREADSSOACC account.(Citation: AADInternals Documentation)"}, {"techniqueID": "T1552", "showSubtechniques": true}, {"score": 1, "techniqueID": "T1552.001", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can gather unsecured credentials for Azure AD services, such as Azure AD Connect, from a local machine.(Citation: AADInternals Documentation)"}, {"score": 1, "techniqueID": "T1552.004", "showSubtechniques": true, "comment": "[AADInternals](https://attack.mitre.org/software/S0677) can gather encryption keys from Azure AD services such as ADSync and Active Directory Federated Services servers.(Citation: AADInternals Documentation)"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by AADInternals", "color": "#66b1ff"}]}